%------------------------------------------------------------------------
\begin{itemframe}{مسئله شار بیشینه}{اثبات روش فورد-فولکرسون}
\item[-]
با نحوه کار روش فورد-فولکرسون آشنا شدیم. امّا چرا این روش به درستی کار می‌کند؟
\item[-]
در این بخش اثبات درستی این روش را خواهیم دید. برای اثبات‌ها نیاز است مفاهیمی که در بخش قبل با آنها آشنا شدیم را به طور رسمی به زبان ریاضی تعریف کنیم.
\end{itemframe}

%------------------------------------------------------------------------
\begin{itemframe}{مسئله شار بیشینه}{اثبات روش فورد-فولکرسون}
\item[-]
تعریف رسمی گراف متمم:
\item
در تعریف شبکه شار گفتیم f تابعیست که شار یال‌ها را بازمی‌گرداند. برای شبکه شار G با تابع ظرفیت c و یک شار مانند f بر روی این شبکه، گراف متمم را با
\m{G_f}
و شار آن را با
\m{f'}
 نشان می‌دهیم.
\item
 دقت کنید که f جزئی از تعریف G نیست و یک شبکه شار می‌تواند f های مختلفی داشته باشد. بنابراین این نحوه نوشتار (
\m{G_f}
) مشخص می‌کند گراف متمم متناظر با کدام شبکه و کدام شار از شبکه است.
\end{itemframe}

%------------------------------------------------------------------------
\begin{itemframe}{مسئله شار بیشینه}{اثبات روش فورد-فولکرسون}
\item
تابع ظرفیت گراف متمم به این صورت تعریف می‌شود:
\begin{mnum}
c_f(u, v)=
\begin{cases}
c(u, v)-f(u, v)& \text{if} (u, v) \in E\\

f(v, u)& \text{if} (v, u) \in E\\
0 &\text{otherwise}
\end{cases}
\end{mnum}

\item
تعریف می‌کنیم مقدار تابع c برای یال‌هایی که در گراف وجود ندارند صفر است(پیش از این اشاره کردیم که تابع f نیز همین ویژگی را دارد). این مسئله برای فهم فرمول بالا ضروری است. برای درک بهتر فرمول بالا را در حالت‌های حدی بررسی کنید.(از ظرفیت یال کاملاً استفاده شود، شار یک یال دارای ظرفیت صفر باشد، بین دو رأس یالی وجود نداشته باشد)

\end{itemframe}

%------------------------------------------------------------------------
\begin{itemframe}{مسئله شار بیشینه}{اثبات روش فورد-فولکرسون}
\item[-]
تعریف افزایش شار:
\item
به اعمال تغییرات گراف متمم بر شبکه شار augmentation گفته می‌شود. در ترجمه فارسی از کلمه «افزایش» استفاده می‌کنیم هرچند منظور از این ترجمه، افزایش شار نیست بلکه افزودن شار گراف متمم بر شارِ شبکه شار است.
\item
افزودن شار f به
\m{f'}
را با
\m{f \uparrow f'}
نشان می‌دهیم. و به این صورت تعریف میکنیم:
\begin{align}
f \uparrow f'(u, v)=
\begin{cases}
f(u, v)+f'(u, v)-f'(v, u)& \text{if} (u, v) \in E\\
0 &\text{otherwise}
\end{cases}
\label{aug-flow-def}
\end{align}
\end{itemframe}

%------------------------------------------------------------------------
\begin{itemframe}{مسئله شار بیشینه}{اثبات روش فورد-فولکرسون}
\item[-]
\m{f \uparrow f'}
نیز یک تابع است که به هر جفت رأس یک مقدار نسبت می‌دهد. ادعا می‌کنیم که این تابع نیز تابع شار است و می‌توانیم آن را جایگزین f کنیم. برای اثبات این ادعا باید ثابت کنیم
\m{f \uparrow f'}
ویژگی‌های تابع شار را دارد. تابع شار تابعی است که به هر جفت رأس یک مقدار نسبت می‌دهد و:
\item[1]
از ظرفیت‌های شبکه شار تجاوز نمی‌کند.
\item[2]
از قانون پایستگی شار پیروی می‌کند.
\item
بنابراین باید بررسی آیا
\m{f \uparrow f'}
این دو ویژگی را دارد یا خیر.
\end{itemframe}

%------------------------------------------------------------------------
\begin{itemframe}{مسئله شار بیشینه}{اثبات روش فورد-فولکرسون}
\item[-]
ویژگی اول به سادگی با توجه به فرمول‌های ۱ و ۲ اثبات می‌شوند. به فرمول ۱ دقت کنید‍؛ شار ظرفیت موافق به دقیقا برابر با تفاضل شار فعلی و حداکثر ظرفیت تعریف می‌شود بنابراین حتی اگر از تمام ظرفیت یال موافق در گراف متمم استفاده کنیم، شار
\m{f \uparrow f'}
از حداکثر نفوذ نمی‌کند.
\item
به دلایل مشابه و با توجه به تعاریف می‌توان اثبات کرد که شار
\m{f \uparrow f'}
از صفر کمتر نمی‌شود.
\end{itemframe}
%------------------------------------------------------------------------
\begin{itemframe}{مسئله شار بیشینه}{اثبات روش فورد-فولکرسون}
\item[-]
برای اثبات ویژگی دوم (پایستگی شار) ابتدا باید ثابت کنیم این رابطه برای هر u برقرار است:

\begin{align}
\sum_{v\in V} f \uparrow f'(u, v)  & - \sum_{v\in V} f \uparrow f'(v, u) \notag \\
&=
 \sum_{v\in V} f(u, v) - \sum_{v\in V} f (v, u)
+
\sum_{v\in V} f'(u, v) - \sum_{v\in V} f'(v, u)
\label{cons}
\end{align}
\item

به زبان ساده این رابطه می‌گوید به ازای هر رأس مثل u\\
تفاضل شار وارد و خارج شونده به u در
\m{ f \uparrow f'} \\
=\\
تفاضل شار وارد و خارج شونده به u در
\m{f} \\
+\\
تفاضل شار وارد و خارج شونده به u در
\m{f'}\\


\end{itemframe}
%------------------------------------------------------------------------
\begin{itemframe}{مسئله شار بیشینه}{اثبات روش فورد-فولکرسون}
\item
در اینجا تساوی \ref{cons} را اثبات نمی‌کنیم. با اعمال رابطه \ref{aug-flow-def} به سمت چپ تساوی این اثبات قابل انجام است. امّا درستی این رابطه به صورت شهودی نیز قابل فهم است؛
\\
شار گراف متمم به همه یال‌ها افزوده شده بنابراین انتظار داریم مقدار شار ورودی به هر رأس، به اندازه شار ورودی به همان رأس در
\m{f'}
افزایش داشته‌باشد. این مسئله برای مجموع شار خروجی نیز صادق است.
\item
اگر به سمت راست این تساوی دقت کنید برابر صفر است زیرا پایستگی در هر دو شار
\m{f}
و
\m{f'}
برقرار است. بنابراین در هر دو شار وارد شونده به یک رأس با شار خارج شونده از آن برابر است. (به غیر از s و t که پایستگی شار در آنها وجود ندارد.)
\end{itemframe}
%------------------------------------------------------------------------
\begin{itemframe}{مسئله شار بیشینه}{اثبات روش فورد-فولکرسون}
\item
حال اگر سمت راست \eq{cons} را صفر بگذاریم نتیجه می‌گیریم:
\begin{align*}
\sum_{v\in V} f \uparrow f'(u, v)  = \sum_{v\in V} f \uparrow f'(v, u)
\end{align*}

\item
بنابراین پایستگی شار در
\m{ f \uparrow f'}
برقرار است. توجه کنید که
\m{f}
و
\m{f'}
هر دو قانون پایستگی شار را رعایت می‌کنند بنابراین قابل انتظار است که شار حاصل افزودن این دو شار نیز چنین باشد.
\end{itemframe}
%------------------------------------------------------------------------
\begin{itemframe}{مسئله شار بیشینه}{اثبات روش فورد-فولکرسون}
\item [-]
تا اینجا ثابت کردیم
\m{ f \uparrow f'}
یک تابع شار است پس قابلیت اعمال بر شبکه شار را دارد، امّا این کافی نیست. می‌خواهیم انجام این کار باعث افزایش مقدار
\m{|f|}
شود. به عبارت دیگر
\m{|f \uparrow f'|}
بزرگ‌تر از
\m{|f|}
باشد.
\item
خواهیم دید که اگر
\m{f'}
به این صورت تعریف شود، این اتفاق همیشه می‌افتد:
\begin{align}
f_p(u, v)=
\begin{cases}
c_p& \text{if} (u, v) \in P\\
0 &\text{otherwise}
\end{cases}
\label{aug-path}
\end{align}


\item
در تعریف بالا p یک مسیر افزایشی در گراف متمم است. و
\m{c_p}
بیشترین شاری است که می‌تواند در این مسیر جریان یابد. این مقدار برابر است با:
\begin{align}
c_f(p) = min \{c_f(u, v): (u, v) \in p\}
\label{path-cap}
\end{align}

\end{itemframe}
%------------------------------------------------------------------------

\begin{itemframe}{مسئله شار بیشینه}{اثبات روش فورد-فولکرسون}

\item
برای اینکه ثابت کنیم افزودن
\m{f_p}
به
\m{f}
مقدار
\m{|f|}
را افزایش می‌دهد. باید ثابت کنیم این رابطه برقرار است:
\begin{align}
|f \uparrow f'|=|f| + |f'|
\label{aug-flow-sum}
\end{align}
\item

پیش از این با
\eq{cons}
آشنا شدیم. دیدیم این معادله به ازای هر
\m{u \in E}
برقرار است. کافیست به جای u رأس s را در آن قرار دهید تا
\eq{aug-flow-sum}
نتیجه شود. (توجه کنید که در دو رأس s و t پایستگی شار وجود ندارد بنابراین سمت راست تساوی لزوماُ برابر صفر نخواهد‌شد.)
\item
به زبان ساده این رابطه می‌گوید مقدار شار در شبکه شار افزایش یافته (augmented) برابر است با مجوع شار شبکه شار اولیه و گراف متمم.
\end{itemframe}
%------------------------------------------------------------------------

\begin{itemframe}{مسئله شار بیشینه}{اثبات روش فورد-فولکرسون}
\item
بنابراین طبق
\eq{aug-flow-sum}
می‌دانیم:
\begin{align*}
|f \uparrow f_p| = |f| + |f_p|
\end{align*}
\item
کافیست ثابت کنیم شار گراف متمم که از روی یک مسیر افزایشی به دست آمده الزاماُ مثبت است و بنابراین
\begin{align*}
|f \uparrow f_p| > |f|
\end{align*}
\item
اثبات اینکه
\m{|f_p|}
مثبت است ساده است؛ می‌دانیم p یک مسیر ساده از s به t است بنابراین نمی‌تواند یال ورودی به s داشته باشد و دقیقا یک یال خروجی از s دارد.
\item
شار گذرنده از یال خروجی s برابر با کمترین ظرفیت مسیر p است(
\eq{path-cap}
).  می‌دانیم یالی در مسیر p وجود ندارد که ظرفیت ۰ یا منفی داشته باشد. زیرا چنین یالی اصلاً در گراف متمم وجود ندارد (طبق تعریف، ظرفیت مقداری مثبت است و ظرفیت صفر به معنای عدم وجود یال در گراف متمم است.)
\end{itemframe}