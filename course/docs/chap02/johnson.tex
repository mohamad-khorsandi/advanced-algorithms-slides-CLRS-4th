
%------------------------------------------------------------------------
\begin{frame}{الگوریتم جانسون}
\begin{itemize}\itemr
\item[-]
الگوریتم جانسون مانند الگوریتم فلوید وارشال برای یافتن کوتاه ترین مسیر بین هر دو راس گراف است. این الگوریتم برای گراف‌های خلوت پبچیدگی زمانی کمتری نسبت به بقیه روش‌ها (فلوید وارشال و روش شبیه‌سازی ضرب ماترسی) دارد.

\item[-]
الگوریتم جانسون -مانند الگوریتم بلمن فورد- می‌تواند روی گراف دارای یال منفی کوتاه ترین مسیر را به درستی محاسبه کند و وجود دور منفی در گراف را تشخیص و گزارش دهد. (گراف دارای دور منفی در مسئله کوتاه ترین مسیر یک حالت خطا محسوب می‌شود.)
\footnote{برای گراف دارای دور منفی یافتن کوتاه ترین مسیر ساده می‌تواند کاربرد داشته‌باشد. این مسئله ان‌پی-سخت است.}
\end{itemize}
\end{frame}

%------------------------------------------------------------------------
\begin{frame}{الگوریتم جانسون}
	\begin{itemize}\itemr
\item[-]
برای طراحی یک الگوریتم مسئله کوتاه‌ترین مسیر بین هر جفت رأس می‌توان V بار اجرا کردن یکی از الگوریتم‌های کوتاه‌ترین مسیرهای هم مبداء را به عنوان یک حد بالا برای مرتبه زمانی تحلیل کرد.

\item[-]
برای مثال
\m{|V|}
بار اجرای الگوریتم بلمن فورد مرتبه
\m{O(V^2E)}
و
\m{|V|}
بار اجرای الگوریتم دایجسترا مرتبه
\m{O(VE+V^2lgV)}
را به دست می‌دهد.
\item[-]
روش دوم سریع‌تر است امّا در گراف‌‌هایی که یال منفی داشته باشند به درستی کار نمی‌کند.
	\end{itemize}
\end{frame}

%------------------------------------------------------------------------
\begin{frame}{الگوریتم جانسون}
\begin{itemize}\itemr
\item[-]
الگوریتم جانسون نیز از ایده‌ایی مشابه استفاده می‌کند. این الگوریتم هر دو الگوریتم بلمن-فورد و دایجسترا را فراخوانی می‌کند؛
\item[۱]
جانسون در مرحله اول، الگوریتم بلمن-فورد را استفاده می‌کند تا وجود دور منفی را تشخیص دهد و در صورتی که دور منفی وجود داشت آن را گزارش داده و کار تمام می‌شود.
\item[۲]
در صورتی که دور منفی وجود نداشت، این الگوریتم با استفاده از روشی که در ادامه بررسی خواهد شد، همه وزن‌ها را به مقادیر غیر منفی نگاشت می‌کند.
\item[۳]
حال که همه وزن‌‌های غیر منفی شده‌اند برای هر رأس یک بار الگوریتم دایجسترا اجرا می‌شود تا کوتاه ترین مسیرها از هر رأس به بقیه رئوس محاسبه شوند.
\end{itemize}
\end{frame}

%------------------------------------------------------------------------
\begin{frame}{الگوریتم جانسون}
	\begin{itemize}\itemr
\item[-]
اما چطور باید وزن‌های گراف را به مقادیر غیر منفی نگاشت کرد؟ واضح است که بعد از تغییر وزن‌ها نباید کوتاه ترین مسیرها را تغییر کنند. برای مثال اضافه کردن یک مقدار ثابت به همه وزن‌ها نگاشت مناسبی نیست. برای درک بهتر این موضوع به مثال زیر توجه کنید:
\begin{center}
	\begin{tikzpicture}[->]
		\node[circle,draw] (S) at (0,0) {S};
		\node[circle,draw] (G) at (8,0) {G};
		\node[circle,draw] (A) at (2,1) {A};
		\node[circle,draw] (B) at (4,1) {B};
		\node[circle,draw] (C) at (6,1) {C};

		\draw (S) -- node[below] {5} (G);
		\draw (S) -- node[above] {1} (A);
		\draw (A) -- node[above] {1} (B);
		\draw (B) -- node[above] {1} (C);
		\draw (C) -- node[above] {1} (G);
	\end{tikzpicture}
\end{center}
\item[-]
اضافه کردن یک واحد به همه یال‌ها کوتاه ترین مسیر از S به G را تغییر می‌دهد:

\begin{center}
	\begin{tikzpicture}[->]
		\node[circle,draw] (S) at (0,0) {S};
		\node[circle,draw] (G) at (8,0) {G};
		\node[circle,draw] (A) at (2,1) {A};
		\node[circle,draw] (B) at (4,1) {B};
		\node[circle,draw] (C) at (6,1) {C};

		\draw (S) -- node[below] {6} (G);
		\draw (S) -- node[above] {2} (A);
		\draw (A) -- node[above] {2} (B);
		\draw (B) -- node[above] {2} (C);
		\draw (C) -- node[above] {2} (G);
	\end{tikzpicture}
\end{center}

	\end{itemize}
\end{frame}

%------------------------------------------------------------------------
\begin{frame}{الگوریتم جانسون}
	\begin{itemize}\itemr
\item[-]
بیایید ویژگی‌های این تغییر وزن را به طور دقیق‌تر بررسی کنیم؛\\
فرض کنید وزن‌های گراف توسط تابعی به نام «تابع وزن»
\fn{1}{weight function}
داده شده. به طوری که وزن یال بین u و v برابر است با
\m{w(u, v)}.
آنگاه تابع وزن جدیدی مانند
\m{\hat{w}}
باید این دو ویژگی را داشته باشد:
\item[1]
به ازای هر
\m{u, v \in E}
مسیری مانند p با استفاده از تابع وزن
\m{w}
یک کوتاه ترین مسیر از u به v است اگر و تنها اگر مسیر p با استفاده از تابع وزن
\m{\hat{w}}
نیز یک کوتاه ترین مسیر باشد.
\item[2]
به ازای هر
\m{u, v \in E}
مقدار
\m{\hat{w}(u, v)}
غیر منفی باشد.
	\end{itemize}
\end{frame}

%------------------------------------------------------------------------
\begin{frame}{الگوریتم جانسون}
	\begin{itemize}\itemr
\item[-]
الگوریتم جانسون از این تغییر وزن استفاده می‌کند:
\begin{align*}
	\m{\hat{w}(u, v)} = \m{w(u, v)} + h(u) - h(v)
\end{align*}
\item[-]
به طوری که u رأس شروع و v رأس پایان یال است و h تابعی است که به هر رأس یک عدد حقیقی نسبت می‌دهد.
\item[-]
در ادامه ثابت خواهیم کرد که این تغییر وزن به ازای هر تابع h کوتاه‌ترین مسیرها را تغییر نمی‌دهد اما برای تبدیل همه وزن‌ها به مقادیر غیر منفی، تابع h باید به درستی تعریف شود.
	\end{itemize}
\end{frame}
%------------------------------------------------------------------------
\begin{frame}{الگوریتم جانسون}
	\begin{itemize}\itemr
		\item[-]
		ابتدا باید ثابت ‌کنیم رابطه تغییر وزن ارائه شده ویژگی اول را ارضاء می‌کند.
		\item
		فرض کنید
		\m{ p= \langle v_0, v_1, ..., v_k \rangle}
		یک مسیر از
		\m{v_0}
		به
		\m{v_k}
		باشد. همچنین وزن کل مسیر p با تابع وزن w را با  w(p) نشان می‌دهیم. آنگاه
		\m{\hat{w}}
		برابر است با:
		\begin{align*}
			\m{\hat{w}(p)= (\hat{w}(v_0, v_1) + h(v_0) -  h(v_1)) + (\hat{w}(v_1, v_2) + h(v_1) -  h(v_2)) + }
			\\
			\m{(\hat{w}(v_2, v_3) + h(v_2) -  h(v_3)) + ... + (\hat{w}(v_{k-1}, v_k) + h(v_{k-1}) -  h(v_k))}
		\end{align*}

	\end{itemize}
\end{frame}
%------------------------------------------------------------------------
\begin{frame}{الگوریتم جانسون}
	\begin{itemize}\itemr
		\item
		رابطه بالا نشان می‌دهد برای هر رأس مثل u، مقدار h(u) به وزن یک یال اضافه می‌شود و از یال بعدی کسر می‌شود (به غیر از رأس ابتدا و انتهای مسیر). بعد از ساده‌سازی به این رابطه می‌رسیم:
		\begin{align*}
			\m{\hat{w}(p)=w(p) + h(h(v_0) - h(v_k)}
		\end{align*}
		\item
		بنابراین برای هر دو رأس مشخص به همه کوتاه‌ترین مسیرهای بین آن دو رأس یک مقدار ثابت اضافه می‌شود پس این نگاشت وزن کوتاه ترین مسیرها را تغییر نمی‌دهد.
	\end{itemize}
\end{frame}

%------------------------------------------------------------------------
\begin{frame}{الگوریتم جانسون}
	\begin{itemize}\itemr
		\item[-]
		هدف بعدی این است که شرایطی فراهم کنیم که ویژگی دوم هم برقرار باشد. برای این کار یک رأس جدید به نام s به گراف اضافه می‌کنیم. سپس این رأس را با یال‌هایی با وزن صفر به همه رئوس دیگر متصل می‌کنیم به طوری که یال ‌ها از s خارج شوند.
		\begin{figure}[h!]
			\centering
			\includegraphics[width=.4\textwidth]{figs/chap02/4.png}
		\end{figure}
		شکل بالا نمونه‌ایی از این تغییر را نشان می‌دهد (رأس آبی رنگ به گراف اضافه شده‌است).
	\end{itemize}
\end{frame}

%------------------------------------------------------------------------
\begin{frame}{الگوریتم جانسون}
	\begin{itemize}\itemr
		\item
		سپس تعریف می‌کنیم مقدار h برای هر رأس مثل v برابر است با کوتاه ترین مسیر از s به v . در شکل بالا نیز اعداد نوشته‌شده بر رأس‌ها به همین طریق محاسبه شده‌اند.
		\item
		حال با استفاده از نامساوی مثلثاتی می‌دانیم که به ازای هر
		\m{(u, v \in E)}
		رابطه زیر برقرار است:
		\begin{center}
			\m{h(v) \leqslant h(u)+w(u, v) } \\

		\end{center}
		\item
		اگر رابطه بالا برقرار نباشد نتیجه می‌شود که مسیر h(v) کوتاه‌ترین مسیر نبوده و به تناقض می‌رسیم.
		\item
		سپس h(u) را به سمت راست نامساوی می‌بریم:
		\begin{center}
			\m{0\leqslant w(u, v) + h(u) - h(v)}
		\end{center}
		\item
		سمت راست این نامساوی همان رابطه‌ایی است که برای $\hat{w}$ تعریف شد. بنابراین ثابت شد که به ازای هر
		\m{(u, v \in E)}
		مقدار $\hat{w}$ غیر منفی است.
	\end{itemize}
\end{frame}

%------------------------------------------------------------------------
\begin{frame}{الگوریتم جانسون}
	\begin{itemize}\itemr
		\item[-]
		درستی الگوریتم جانسون ثابت شد. شکل زیر یک نمونه از گراف تغییر وزن یافته توسط الگوریتم جانسون است:
		\begin{figure}[h!]
			\centering
			\includegraphics[width=.3\textwidth]{figs/chap02/5.png}
		\end{figure}

		\item[-]
		قبلا اشاره شد که الگوریتم جانسون از الگوریتم بلمن-فورد برای تشخیص دور منفی استفاده می‌کند. همچنین دیدم که برای محاسبه تابع h نیاز به مقادیر کوتاه‌ترین مسیر از s به بقیه رئوس نیاز داریم. می‌دانیم الگوریتم بلمن-فورد توانایی محاسبه هر دوی این موارد را دارد. بنابراین الگوریتم جانسون با یک بار اجرای بلمن-فورد هم کوتاه‌ترین مسیرها از s را محاسبه می‌کند و هم وجود دور منفی را تشخیص می‌دهد.

	\end{itemize}
\end{frame}

%------------------------------------------------------------------------
\begin{frame}{الگوریتم جانسون}
	\begin{itemize}\itemr
		\item[-]
		برای یافتن وزن اصلی یک مسیر از رابطه زیر استفاده می‌کنیم:
		\begin{center}
			\m{w(p(u, v)) = \hat{w}(p(u, v)) + h(v) - h(u) }
		\end{center}

		\item[-]
		در نهایت به تحیلی پیچیدگی زمانی الگوریتم جانسون می‌پردازیم:
		\item
		اجرای $|V|$ بار الگوریتم دایجسترا زمان‌برترین مرحله الگوریتم جانسون است بنابراین -مانند دایجسترا- باید گراف را در لیست مجاورتی ذخیره کنیم. حال اگر فرض کنیم الگوریتم دایجسترا با استفاده از هرم فیبوناچی پیاده‌سازی شده‌است، پیچیدگی زمانی برابر است با
		\m{O(V^2lgV+VE)}
		که از ضرب یک
		\m{|V|}
		در مرتبه زمانی دایجسترا به دست آمده‌است.
		\item
		در صورتی که گراف خلوت باشد مرتبه زمانی این الگوریتم برابر است
		\m{O(V^2lgV)}.
		در حالی که الگوریتم فلوید-وارشال برای گراف خلوت از مربته زمانی
		\m{O(V^3)}
		است.

	\end{itemize}
\end{frame}