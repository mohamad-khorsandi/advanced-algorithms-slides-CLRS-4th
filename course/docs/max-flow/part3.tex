\begin{itemframe-s}{تطابق بیشینه در گراف دو بخشی}{مقدمه}
\itm
برخی مسائل ترکیبیاتی را می‌توان به‌صورت مسائل شار بیشینه‌ مدل‌سازی کرد، مانند مسئلهٔ شار بیشینه با چندین مبدأ و مقصد که پیش از این مطرح شد.

\itm
برخی دیگر از مسائل ترکیبیاتی در ظاهر ارتباطی با شبکه‌های شار ندارند، اما در واقع می‌توان آن‌ها را به مسائل بیشینه‌جریان کاهش داد. در ادامه یکی از این مسائل را معرفی می‌کنیم:
 یافتن یک تطابق بیشینه در یک گراف دو بخشی
\fn{bipartite graph} .

\itm
خواهیم دید که چگونه می‌توان از روش فورد-فالکرسون برای حل مسئلهٔ تطابق بیشینه گراف دو بخشی
\fn{maximum bipartite matching}
 در زمان استفاده کرد. زمان اجرای آن $O(|V||E|)$ می‌باشد.
\end{itemframe-s}


\begin{itemframe-s}{تطابق بیشینه در گراف دو بخشی}{تعاریف}
\itm
با داشتن یک گراف بدون جهت
$G = (V, E)$
، یک تطابق
\fn{matching}
 زیرمجموعه‌ای از یال‌ها به‌صورت
$M \subseteq E$
 است به‌طوری‌که برای تمام رأس‌های
$v \in V$،
 \textbf{حداکثر یک}
 یال از $M$ به $v$ متصل باشد.
\itm

می‌گوییم یک رأس $v \in V$ توسط تطابق $M$ تطبیق‌یافته
\fn{matched}
است اگر یالی در $M$ وجود داشته باشد که به $v$ متصل باشد؛ در غیر این صورت، $v$ تطبیق‌نیافته
\fn{unmatched}
 است.

\itm
یک تطابق بیشینه
\fn{maximum matching}
، تطابقی با بیشترین تعداد یال است؛ $M$ تطابق بیشینه است اگر برای هر تطابق دیگر $M'$، داشته باشیم
$|M| \geq |M'|$.

\end{itemframe-s}


\begin{itemframe-s}{تطابق بیشینه در گراف دو بخشی}{تعاریف}
\itm
در این بخش، تمرکز ما بر یافتن تطابق‌های بیشینه در گراف‌های دو بخشی
\fn{bipartite graphs}
 است: گراف‌هایی که مجموعهٔ رأس‌های آن‌ها را می‌توان به‌صورت
$V = L \cup R$
افراز کرد، به‌طوری‌که $L$ و $R$ مجزا باشند و تمام یال‌ها یک رأس در $L$ داشته باشند و رأس دیگر آنها در $R$ باشد.
\itm
علاوه بر این، فرض می‌کنیم همه رأس‌های گراف حداقل به یک یال متصل هستند.
\end{itemframe-s}


\begin{itemframe}{تطابق بیشینه در گراف دو بخشی}
\itm
شکل زیر دو تطابق مختلف در یک گراف دو بخشی را نشان می‌دهد. یال‌های هر تطابق با رنگ آبی نشان داده شده‌اند.
\centerimg{figs/max-flow/13.png}

\end{itemframe}


\begin{itemframe-s}{تطابق بیشینه در گراف دو بخشی}{کاربرد‌ها}
\itm
مسئلهٔ یافتن تطابق بیشینه در یک گراف دو بخشی، کاربردهای عملی فراوانی دارد.
\itm
 به‌عنوان مثال، فرض کنید بخواهیم مجموعه‌ای از افراد‌ به نام $L$ را با مجموعه‌ای از وظایف به نام $R$ که باید به‌صورت هم‌زمان انجام شوند، تطبیق دهیم.

یک یال
 $(u, v) \in E$
نشان می‌دهد که فرد خاصی قادر به انجام وظیفهٔ خاصی است.
\itm
بنابراین هر تطابق یک انتساب وظایف به افراد‌ است و یک تطابق بیشینه، برای بیشترین تعداد ممکن از افراد‌ کار فراهم می‌کند.
\end{itemframe-s}


\begin{itemframe-s}{تطابق بیشینه در گراف دو بخشی}{تطابق بیشینه با روش فورد-فولکرسون}
\itm
روش فورد-فالکرسون مبنایی برای یافتن تطابق بیشینه در یک گراف دوبخشی بدون جهت فراهم می‌کند. نکتهٔ کلیدی در اینجا ساخت یک شبکهٔ شار است به‌گونه‌ای که شار متناظر با تطابق باشد. در شکل زیر ساخت شبکه شار از گراف دوبخشی نشان داده شده است.
\centerimg{figs/max-flow/14.png}

\end{itemframe-s}


\begin{itemframe-s}{تطابق بیشینه در گراف دو بخشی}{تطابق بیشینه با روش فورد-فولکرسون}
\itm
«شبکهٔ جریان متناظر»
\fn{corresponding flow network}
 $G' = (V', E')$
را برای گراف دوبخشی $G$ به صورت زیر تعریف می‌کنیم:
علاوه بر رئوس مجموعه $V$ دو رأس جدید مبدأ $s$ و رأس مقصد $t$ نیز به $'V$ اضافه می‌کنیم.
اگر افراز رأس‌های گراف $G$ به دو مجموعه $L$ و $R$ باشد، یال‌های جهت‌دار گراف $G'$ به صورت زیر تعریف می‌شوند:
\begin{align*}
E' = & \{(s, u) \mid u \in L\}
 	  &\cup \{(u, v) \mid u \in L,\, v \in R,\; (u, v) \in E\}
	  &\cup \{(v, t) \mid v \in R\}
\end{align*}
\itm
در نهایت، به هر یال در $E'$
 \textbf{ظرفیت}
واحد (مقدار ۱) اختصاص می‌دهیم.
\itm
به سادگی ثابت می‌شود:
$$
|E| \leq |E'| \leq 3|E|
$$
بنابراین افزایش تعداد یال‌ها از نظر مجانبی مرتبه تعداد یال‌ها را تغییر نمیدهد(
$|E'| = \Theta(|E|)$
).
\end{itemframe-s}


\begin{itemframe-s}{تطابق بیشینه در گراف دو بخشی}{تطابق بیشینه با روش فورد-فولکرسون}
\itm
می‌خواهیم نشان دهیم که یک تطبیق در گراف دو بخشی $G$ با یک شار در شبکه شار $G'$ متناظر است.
\itm
به یک شار مانند $f$، «شار صحیح»
\fn{integer-valued}
 می‌گوییم اگر برای همه‌ی مقدار شار آن روی همه یال‌ها عدد صحیح باشد.
\itm
امّا منظور متناظر بودن شار و تطابق چیست؟ در ادامه یک تعریف رسمی به همین منظور ارائه می‌دهیم.
\end{itemframe-s}


\begin{itemframe-s}{تطابق بیشینه در گراف دو بخشی}{تطابق بیشینه با روش فورد-فولکرسون}
\itm
ادعایی که باید ثابت شود به این ترتیب است:
\itm
فرض کنید $G = (V, E)$ یک گراف دو بخشی با تقسیم رأس‌ها به صورت $V = L \cup R$ باشد، و $G' = (V', E')$ شبکه‌ی جریان متناظر آن باشد. اگر $M$ یک تطبیق در $G$ باشد، آنگاه یک شار صحیح $f$ در $G'$ وجود دارد به‌طوری‌که $|f| = |M|$.
\itm
 برعکس، اگر $f$ یک جریان صحیح در $G'$ باشد، آنگاه تطبیقی مثل $M$ در $G$ با اندازه‌ی
$|M| = |f|$
وجود دارد که از یال‌های $(u, v) \in E$ با
 $f(u, v) > 0$
 تشکیل شده است.
\itm
منظور از $|M|$ همان تعداد یال‌های انطباق $M$ است که به آن «کاردینال»
\fn{cardinality}
 انطباق گفته می‌شود.
\end{itemframe-s}


\begin{itemframe-s}{تطابق بیشینه در گراف دو بخشی}{تطابق بیشینه با روش فورد-فولکرسون}
%todo sink should always name same thing in persian
\itm
ابتدا نشان می‌دهیم که یک تطبیق $M$ در $G$ متناظر با یک جریان صحیح $f$ در $G'$ است. $f$ را به‌صورت زیر تعریف می‌کنیم:
\itm
اگر
$(u, v) \in M$
، آنگاه شار تمام یال‌های مسیر زیر را برابر ۱ قرار می‌دهیم؛
$$s \to u \to v \to t$$
 و شار سایر یال‌ها را برابر صفر قرار می‌دهیم.
\itm

مشخص است که $f$ محدودیت ظرفیت و قانون بقای جریان را ارضا می‌کند و هر یال در تطابق مانند
$(u, v)$
معادل با یک واحد جریان در $G'$ است که از مسیر
$s \to u \to v \to t$
به رأس منبع می‌رسد. علاوه‌براین، مسیرهای حاصل از یال‌های $M$ به‌جز در رأس‌های $s$ و $t$ رأس‌-ناهمپوشان هستند.
\itm
 جریان خالص عبوری از برش
$(L \cup {s}, R \cup {t})$
برابر با $|M|$ است و بنابراین، مقدار جریان برابر
 $|f| = |M|$
 است.(در بحث شار بیشینه دیدیم که هر شار هر برش با $|f|$ برابر است.)
\end{itemframe-s}


\begin{itemframe-s}{تطابق بیشینه در گراف دو بخشی}{تطابق بیشینه با روش فورد-فولکرسون}
\itm
جهت عکس اثبات به این صورت است:
فرض کنید $f$ یک شار صحیح در $G'$ باشد. ادعا می‌کنیم مجموعه زیر یک تطابق است.
$$
M = \{ (u, v) \mid u \in L,\ v \in R,\ \text{and } f(u,v) > 0 \}
$$
بعد از اثبات این ادعا باید ثابت کنیم $|M| = |f|$ می‌باشد.
\itm
برای اثبات این ادعا باید نشان دهیم هر
$ (u, v) $
که شار داشته باشد قسمتی از مسیر
$s \to u \to v \to t$
که از آن دقیقاً یک واحد شار می‌گذرد و بنابراین هر $u$ و $v$ حداکثر یک بار در مجموعه $M$ ضاهر می‌شوند.
\itm
می‌دانیم هر رأس
 $u \in L$
دقیقاً یک یال ورودی دارد که ظرفیت آن ۱ است.
اگر به یک  $u \in L$  دقیقاً یک واحد شار وارد شود باید همان مقدار نیز خارج شود.
از آنجا که $f$ مقادیر صحیح دارد، به ازای هر $u \in L$ تنها یک یال می‌تواند دارای شار باشد. بنابراین، دقیقاً یک رأس $v \in R$ وجود دارد که
$f(u, v) = 1$.

\end{itemframe-s}


\begin{itemframe-s}{تطابق بیشینه در گراف دو بخشی}{تطابق بیشینه با روش فورد-فولکرسون}
\itm
استدلال مشابهی برای هر رأس $v \in R$ برقرار است. در نتیجه، مجموعه $M$ یک تطابق است.

\itm
برای اینکه نشان دهیم $|M| = |f|$، توجه کنید که از میان یال‌های
$(u, v) \in E'$
 با
$u \in L$
 و
$v \in R$
، داریم:
%todo use $$ instead of align*
$$
f(u,v) =
\begin{cases}
1 & \text{ if} (u,v) \in M \\
0 & \text{ if} (u,v) \notin M
\end{cases}
$$

به زبان ساده $(u,v)$ هایی که شار از آنها می‌گذرد در  $M$‌اند و اگر شار آنها صفر باشد در  $M$ نیستند.
%todo translation of flow should be consistent
\itm
در نتیجه، شار خالص عبوری از برش $(L \cup {s}, R \cup {t})$ برابر $|M|$ است.
بنابراین داریم
$$|f| = f(L \cup {s}, R \cup {t}) = |M|$$.
\end{itemframe-s}


\begin{itemframe-s}{تطابق بیشینه در گراف دو بخشی}{تطابق بیشینه با روش فورد-فولکرسون}
\itm
امّا یک مشکل در این استدلال وجود دارد:‌ مسئله شار بیشینه در حالت عادی محدودیتی روی صحیح بودن مقدار شار ندارد. بنابراین یک الگورریتم شار بیشینه در می‌تواند مقادیر غیر صحیح برای شار برخی یال‌ها محاسبه کند. در حالی که می‌دانیم مقدار کلی شار $|f|$ لزوماً صحیح است.
\itm
نشان داده می‌شود که اگر تابع ظرفیت $c$ فقط شامل مقادیر صحیح باشد، آنگاه شار بیشینه‌ی $f$ تولیدشده توسط روش فورد-فالکرسون خاصیت‌های زیر را دارد:
\item[1]
$|f|$
یک عدد صحیح است.
\item[2]
 برای همه‌ی رأس‌های $u$ و $v$، مقدار $f(u, v)$ یک عدد صحیح است.
\end{itemframe-s}


\begin{itemframe-s}{تطابق بیشینه در گراف دو بخشی}{تطابق بیشینه با روش فورد-فولکرسون}
\itm
از اثبات کردیم که هر تطابق در گراف دو بخشی $G$ متناظر با یک شار در شبکه شار $G'$ آن است و بلعکس.
\itm
امّا آیا اندازه‌ی یک تطبیق بیشینه ($|M|$) در یک گراف دو بخشی با اندازه یک شار بیشینه ($|f|$) در شبکه‌ی شار متناظر برابر است؟ به عبارت دیگر اگر یک شار بیشینه در شبکه شار یافت بشود، اندازه آن با بیشینه تطابق در گراف دو بخشی برابر است؟
\itm
برابری این دو نیاز به اثبات دارد. در ادامه اثبات آن را بررسی خواهیم کرد.
\end{itemframe-s}

\begin{itemframe-s}{تطابق بیشینه در گراف دو بخشی}{تطابق بیشینه با روش فورد-فولکرسون}
%todo translation of matching should be consistent
%todo ask this part
\itm
 فرض کنید $M$ یک تطابق بیشینه در $G$ باشد و شار متناظر $f$ در $G'$ بیشینه نباشد. آنگاه شار $f'$ وجود دارد به طوری که $|f'| > |f|$.
\itm
از آنجا که ظرفیت‌ها در $G'$ صحیح هستند، $f'$ نیز یک شار صحیح است.
در این صورت، $f'$ متناظر با تطابقی مثل $M'$ در $G$ با اندازه‌ی
$$|M'| = |f'| > |f| = |M|$$
است، که با فرض بیشینه بودن $M$ در تناقض است.
\itm
به‌صورت مشابه می‌توان نشان داد که اگر $f$ یک جریان بیشینه در $G'$ باشد، تطابق متناظر آن نیز یک تطابق بیشینه در $G$ است.
\end{itemframe-s}


\begin{itemframe-s}{تطابق بیشینه در گراف دو بخشی}{تطابق بیشینه با روش فورد-فولکرسون}
\itm
بنابراین، برای یافتن یک تطبیق بیشینه در یک گراف دو بخشی بدون جهت $G$،
\item[1]
 شبکه‌ی جریان $G'$ را ایجاد می‌کنیم،
\item[2]
روش فورد-فالکرسون را روی $G'$ اجرا می‌کنیم،
\item[3]
 جریان صحیح بیشینه‌ی حاصل را به یک تطبیق بیشینه در $G$ تبدیل می‌کنیم.
\itm
هر تطبیق در یک گراف دو بخشی حداکثر اندازه‌ی
 $\min({|L|, |R|}) $
دارد، بنابراین از مربته
$O(V)$
است.
بنابراین مقدار جریان بیشینه در $G'$ نیز $O(V)$ خواهد بود. پس، یافتن تطبیق بیشینه در یک گراف دو بخشی در زمان
$$O(VE') = O(VE)$$
انجام می‌شود، زیرا
 $|E'| = \Theta(E)$.
\end{itemframe-s}